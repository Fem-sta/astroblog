---
import Layout from "../../layouts/Layout.astro";
import PostCard from "../../components/PostCard.astro";

//utils import
import {formatBlogPost} from "../../js/utils";
import Pagination from "../../components/pagination.astro";
import CategoryCloud from "../../components/CategoryCloud.astro";


export async function getStaticPaths({paginate}){
    const modules =  import.meta.glob("./*.mdx", {eager:true});

    const allPosts = Object.values(modules);
    const formattedPost = formatBlogPost(allPosts);

    return paginate(formattedPost,{
        pageSize:2,
    })
}

const {page} = Astro.props;

---

<Layout title="Blogs">
   
   <section class="container" aria-label="New Blog Posts">
    <h1 class="h1 text-center p-4 mt-10">New Blog Posts</h1>
    <div class="post-container">
    {
        //Loop through all Posts
    page.data.map((post) => <PostCard frontmatter = {post.frontmatter} url={post.url} tagType="h2"/>)
    }
    </div>
    <Pagination prevUrl={page.url.prev} nextUrl={page.url.next}/>
   </section>
   <aside class="container" aria-label="Blog Categories">
    <h2 class="h2">Blog Categories</h2>
    <CategoryCloud showCount={true}/>

   </aside>
</Layout>